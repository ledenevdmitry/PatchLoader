<?xml version="1.0" encoding="windows-1251"?>
<!DOCTYPE POWERMART SYSTEM "powrmart.dtd">
<POWERMART CREATION_DATE="10/02/2018 16:16:21" REPOSITORY_VERSION="182.91">
<REPOSITORY NAME="REP_STDEV10" VERSION="182" CODEPAGE="MS1251" DATABASETYPE="Oracle">
<FOLDER NAME="DWS002_EQ" GROUP="" OWNER="developer1" SHARED="NOTSHARED" DESCRIPTION="" PERMISSIONS="rwx---r--" UUID="2d20803f-1d44-4cc5-be60-a2b01a3291ed">
<MAPPING DESCRIPTION="Заполнение бриджа NA2PFRATE002_BRIDGE_DSRC.&#xD;&#xA;История изменения ставки по накопительному счету." ISVALID="YES" NAME="m_NA2PF002_DELTA__NA2PFRATE002_BRIDGE_DSRC" OBJECTVERSION="1" VERSIONNUMBER="1">
        <TRANSFORMATION DESCRIPTION="" NAME="SQ_NA2PF002_DELTA" OBJECTVERSION="1" REUSABLE="NO" TYPE="Source Qualifier" VERSIONNUMBER="1">
            <TRANSFORMFIELD DATATYPE="string" DEFAULTVALUE="" DESCRIPTION="" NAME="NA2EAN" PICTURETEXT="" PORTTYPE="INPUT/OUTPUT" PRECISION="20" SCALE="0"></TRANSFORMFIELD>
            <TRANSFORMFIELD DATATYPE="double" DEFAULTVALUE="" DESCRIPTION="" NAME="NA2RAT" PICTURETEXT="" PORTTYPE="INPUT/OUTPUT" PRECISION="15" SCALE="0"></TRANSFORMFIELD>
            <TRANSFORMFIELD DATATYPE="double" DEFAULTVALUE="" DESCRIPTION="" NAME="NA2DB" PICTURETEXT="" PORTTYPE="INPUT/OUTPUT" PRECISION="15" SCALE="0"></TRANSFORMFIELD>
            <TRANSFORMFIELD DATATYPE="double" DEFAULTVALUE="" DESCRIPTION="" NAME="NA2DE" PICTURETEXT="" PORTTYPE="INPUT/OUTPUT" PRECISION="15" SCALE="0"></TRANSFORMFIELD>
            <TRANSFORMFIELD DATATYPE="double" DEFAULTVALUE="" DESCRIPTION="" NAME="YAROED" PICTURETEXT="" PORTTYPE="INPUT/OUTPUT" PRECISION="15" SCALE="0"></TRANSFORMFIELD>
            <TRANSFORMFIELD DATATYPE="double" DEFAULTVALUE="" DESCRIPTION="" NAME="YARCED" PICTURETEXT="" PORTTYPE="INPUT/OUTPUT" PRECISION="15" SCALE="0"></TRANSFORMFIELD>
            <TRANSFORMFIELD DATATYPE="string" DEFAULTVALUE="" DESCRIPTION="" NAME="DEL_FLAG" PICTURETEXT="" PORTTYPE="INPUT/OUTPUT" PRECISION="1" SCALE="0"></TRANSFORMFIELD>
            <TABLEATTRIBUTE NAME="Sql Query" VALUE="with na2 as (&#xD;&#xA;--      QC9210&#xD;&#xA;--      select na2ean, na2rat, na2db, na2de&#xD;&#xA;--      from na2pf002_delta na2&#xD;&#xA;--      where $$P_INITIAL_LOADING=0&#xD;&#xA;--      union all&#xD;&#xA;      select na2ean, na2rat, na2db, na2de&#xD;&#xA;      from dws002_eq.na2pf002_mirror na2m&#xD;&#xA;      where exists (select 1 from dws002_eq.na2pf002_delta na2 where na2.na2ean = na2m.na2ean)&#xD;&#xA;      and  $$P_INITIAL_LOADING=0&#xD;&#xA;      union all&#xD;&#xA;      select na2ean, na2rat, na2db, na2de&#xD;&#xA;      from dws002_eq.NA2PF002_MIRROR na2&#xD;&#xA;      where $$P_INITIAL_LOADING=1&#xD;&#xA;            and nvl(na2.dwsarchive,&apos;N&apos;)=&apos;N&apos;&#xD;&#xA;    ),&#xD;&#xA;mir as (&#xD;&#xA;select &#xD;&#xA;*&#xD;&#xA;from &#xD;&#xA;dws002_eq.NA2PFRATE002_BRIDGE_MIRROR na2m&#xD;&#xA;      where exists (select 1 from dws002_eq.na2pf002_delta na2 where na2.na2ean = na2m.na2ean)&#xD;&#xA;      and  $$P_INITIAL_LOADING=0&#xD;&#xA;),&#xD;&#xA;src as (    &#xD;&#xA;select na2ean, na2rat, na2db,&#xD;&#xA;       nvl(lead(na2db) over(partition by na2ean order by na2db), max_de) as na2de,&#xD;&#xA;       yaroed, yarced&#xD;&#xA;from (select na2ean, na2rat, na2db, na2de,&#xD;&#xA;             decode(lag(na2rat) over(partition by na2ean order by na2db), na2rat, 0, 1) ch_flg,&#xD;&#xA;             max(na2de) over(partition by na2ean, na2rat) max_de,&#xD;&#xA;             yaroed, yarced&#xD;&#xA;      from (select na2ean, na2rat, na2db, na2de, yaroed, yarced&#xD;&#xA;            from na2,&#xD;&#xA;                 dws002_eq.yarpfsavings002_bridge_mirror yar&#xD;&#xA;            where na2.na2ean=yar.yarean&#xD;&#xA;                  and nvl(yar.dwsarchive,&apos;N&apos;)=&apos;N&apos;&#xD;&#xA;            union&#xD;&#xA;            select na2ean, na2rat, na2db, na2de, yaroed, yarced&#xD;&#xA;            from dws002_eq.na2pf002_mirror na2,&#xD;&#xA;                 dws002_eq.yarpfsavings002_bridge_delta yar&#xD;&#xA;            where $$P_INITIAL_LOADING=0&#xD;&#xA;                  and na2.na2ean=yar.yarean&#xD;&#xA;                  and nvl(na2.dwsarchive,&apos;N&apos;)=&apos;N&apos;&#xD;&#xA;           )&#xD;&#xA;     )&#xD;&#xA;where ch_flg=1)&#xD;&#xA;select&#xD;&#xA;nvl(src.na2ean, mir.na2ean) na2ean,&#xD;&#xA;nvl(src.na2rat, mir.na2rat) na2rat,&#xD;&#xA;nvl(src.na2db, mir.na2db) na2db,&#xD;&#xA;case when src.na2ean is not null then lead(&#xD;&#xA;case when &#xD;&#xA;                   decode(src.NA2DE,&#xD;&#xA;                   9999999,to_date(&apos;59991231&apos;,&apos;YYYYMMDD&apos;), &#xD;&#xA;                   0, to_date(&apos;59991231&apos;,&apos;YYYYMMDD&apos;), &#xD;&#xA;                   case when length(to_char(src.NA2DE)) &lt; 6 then to_date(&apos;19000101&apos;,&apos;YYYYMMDD&apos;) else &#xD;&#xA;                        to_date(to_char(src.NA2DE+ 19000000),&apos;YYYYMMDD&apos;) + 1&#xD;&#xA;                   end&#xD;&#xA;                   ) = to_date(&apos;59991231&apos;,&apos;YYYYMMDD&apos;) then src.NA2DE&#xD;&#xA;    when &#xD;&#xA;                   decode(src.NA2DE,&#xD;&#xA;                   9999999,to_date(&apos;59991231&apos;,&apos;YYYYMMDD&apos;), &#xD;&#xA;                   0, to_date(&apos;59991231&apos;,&apos;YYYYMMDD&apos;), &#xD;&#xA;                   case when length(to_char(src.NA2DE)) &lt; 6 then to_date(&apos;19000101&apos;,&apos;YYYYMMDD&apos;) else &#xD;&#xA;                        to_date(to_char(src.NA2DE+ 19000000),&apos;YYYYMMDD&apos;) + 1&#xD;&#xA;                   end&#xD;&#xA;                   ) = to_date(&apos;19000101&apos;,&apos;YYYYMMDD&apos;) then src.NA2DE    &#xD;&#xA;   else &#xD;&#xA;                  to_number(to_char(to_date(to_char(src.NA2DE+ 19000000),&apos;YYYYMMDD&apos;) + 1,&apos;YYYYMMDD&apos;))-19000000&#xD;&#xA;   end,1,src.na2de) over (partition by src.na2ean order by src.na2db) else mir.na2de end na2de,&#xD;&#xA;--nvl(src.na2de, mir.na2de) na2de,&#xD;&#xA;nvl(src.yaroed, mir.yaroed) yaroed,&#xD;&#xA;nvl(src.yarced, mir.yarced) yarced,&#xD;&#xA;case when src.na2ean is not null then &apos;N&apos; else &apos;Y&apos; end del_flag&#xD;&#xA;from&#xD;&#xA;src full join mir on &#xD;&#xA;src.na2db = mir.na2db and mir.na2ean = src.na2ean"></TABLEATTRIBUTE>
            <TABLEATTRIBUTE NAME="User Defined Join" VALUE=""></TABLEATTRIBUTE>
            <TABLEATTRIBUTE NAME="Source Filter" VALUE=""></TABLEATTRIBUTE>
            <TABLEATTRIBUTE NAME="Number Of Sorted Ports" VALUE="0"></TABLEATTRIBUTE>
            <TABLEATTRIBUTE NAME="Tracing Level" VALUE="Normal"></TABLEATTRIBUTE>
            <TABLEATTRIBUTE NAME="Select Distinct" VALUE="NO"></TABLEATTRIBUTE>
            <TABLEATTRIBUTE NAME="Is Partitionable" VALUE="NO"></TABLEATTRIBUTE>
            <TABLEATTRIBUTE NAME="Pre SQL" VALUE=""></TABLEATTRIBUTE>
            <TABLEATTRIBUTE NAME="Post SQL" VALUE=""></TABLEATTRIBUTE>
            <TABLEATTRIBUTE NAME="Output is deterministic" VALUE="NO"></TABLEATTRIBUTE>
            <TABLEATTRIBUTE NAME="Output is repeatable" VALUE="Never"></TABLEATTRIBUTE>
        </TRANSFORMATION>
        <TRANSFORMATION DESCRIPTION="" NAME="EXP_PARAMS" OBJECTVERSION="1" REUSABLE="NO" TYPE="Expression" VERSIONNUMBER="1">
            <TRANSFORMFIELD DATATYPE="string" DEFAULTVALUE="" DESCRIPTION="" EXPRESSION="NA2EAN" EXPRESSIONTYPE="GENERAL" NAME="NA2EAN" PICTURETEXT="" PORTTYPE="INPUT/OUTPUT" PRECISION="20" SCALE="0"></TRANSFORMFIELD>
            <TRANSFORMFIELD DATATYPE="date/time" DEFAULTVALUE="ERROR(&apos;transformation error&apos;)" DESCRIPTION="" EXPRESSION="sysdate" EXPRESSIONTYPE="GENERAL" NAME="DWSTIMESTAMP" PICTURETEXT="" PORTTYPE="OUTPUT" PRECISION="29" SCALE="9"></TRANSFORMFIELD>
            <TRANSFORMFIELD DATATYPE="decimal" DEFAULTVALUE="ERROR(&apos;transformation error&apos;)" DESCRIPTION="" EXPRESSION="$$P_DWSJOB" EXPRESSIONTYPE="GENERAL" NAME="DWSJOB" PICTURETEXT="" PORTTYPE="OUTPUT" PRECISION="28" SCALE="0"></TRANSFORMFIELD>
            <TABLEATTRIBUTE NAME="Tracing Level" VALUE="Normal"></TABLEATTRIBUTE>
        </TRANSFORMATION>
        <INSTANCE DESCRIPTION="" NAME="NA2PFRATE002_BRIDGE_DSRC" TRANSFORMATION_NAME="NA2PFRATE002_BRIDGE_DSRC" TRANSFORMATION_TYPE="Target Definition" TYPE="TARGET"></INSTANCE>
        <INSTANCE DBDNAME="ORACLE" DESCRIPTION="" NAME="NA2PF002_MIRROR" TRANSFORMATION_NAME="NA2PF002_MIRROR" TRANSFORMATION_TYPE="Source Definition" TYPE="SOURCE"></INSTANCE>
        <INSTANCE DBDNAME="ORACLE" DESCRIPTION="" NAME="YARPFSAVINGS002_BRIDGE_MIRROR" TRANSFORMATION_NAME="YARPFSAVINGS002_BRIDGE_MIRROR" TRANSFORMATION_TYPE="Source Definition" TYPE="SOURCE"></INSTANCE>
        <INSTANCE DBDNAME="ORACLE" DESCRIPTION="" NAME="NA2PF002_DELTA" TRANSFORMATION_NAME="NA2PF002_DELTA" TRANSFORMATION_TYPE="Source Definition" TYPE="SOURCE"></INSTANCE>
        <INSTANCE DESCRIPTION="" NAME="SQ_NA2PF002_DELTA" REUSABLE="NO" TRANSFORMATION_NAME="SQ_NA2PF002_DELTA" TRANSFORMATION_TYPE="Source Qualifier" TYPE="TRANSFORMATION">
            <ASSOCIATED_SOURCE_INSTANCE NAME="NA2PF002_DELTA"></ASSOCIATED_SOURCE_INSTANCE>
            <ASSOCIATED_SOURCE_INSTANCE NAME="YARPFSAVINGS002_BRIDGE_MIRROR"></ASSOCIATED_SOURCE_INSTANCE>
        </INSTANCE>
        <INSTANCE DESCRIPTION="" NAME="EXP_PARAMS" REUSABLE="NO" TRANSFORMATION_NAME="EXP_PARAMS" TRANSFORMATION_TYPE="Expression" TYPE="TRANSFORMATION"></INSTANCE>
        <CONNECTOR FROMFIELD="DWSJOB" FROMINSTANCE="EXP_PARAMS" FROMINSTANCETYPE="Expression" TOFIELD="DWSJOB" TOINSTANCE="NA2PFRATE002_BRIDGE_DSRC" TOINSTANCETYPE="Target Definition"></CONNECTOR>
        <CONNECTOR FROMFIELD="NA2EAN" FROMINSTANCE="SQ_NA2PF002_DELTA" FROMINSTANCETYPE="Source Qualifier" TOFIELD="NA2EAN" TOINSTANCE="NA2PFRATE002_BRIDGE_DSRC" TOINSTANCETYPE="Target Definition"></CONNECTOR>
        <CONNECTOR FROMFIELD="NA2RAT" FROMINSTANCE="SQ_NA2PF002_DELTA" FROMINSTANCETYPE="Source Qualifier" TOFIELD="NA2RAT" TOINSTANCE="NA2PFRATE002_BRIDGE_DSRC" TOINSTANCETYPE="Target Definition"></CONNECTOR>
        <CONNECTOR FROMFIELD="NA2DB" FROMINSTANCE="SQ_NA2PF002_DELTA" FROMINSTANCETYPE="Source Qualifier" TOFIELD="NA2DB" TOINSTANCE="NA2PFRATE002_BRIDGE_DSRC" TOINSTANCETYPE="Target Definition"></CONNECTOR>
        <CONNECTOR FROMFIELD="NA2DE" FROMINSTANCE="SQ_NA2PF002_DELTA" FROMINSTANCETYPE="Source Qualifier" TOFIELD="NA2DE" TOINSTANCE="NA2PFRATE002_BRIDGE_DSRC" TOINSTANCETYPE="Target Definition"></CONNECTOR>
        <CONNECTOR FROMFIELD="YAROED" FROMINSTANCE="SQ_NA2PF002_DELTA" FROMINSTANCETYPE="Source Qualifier" TOFIELD="YAROED" TOINSTANCE="NA2PFRATE002_BRIDGE_DSRC" TOINSTANCETYPE="Target Definition"></CONNECTOR>
        <CONNECTOR FROMFIELD="YARCED" FROMINSTANCE="SQ_NA2PF002_DELTA" FROMINSTANCETYPE="Source Qualifier" TOFIELD="YARCED" TOINSTANCE="NA2PFRATE002_BRIDGE_DSRC" TOINSTANCETYPE="Target Definition"></CONNECTOR>
        <CONNECTOR FROMFIELD="DWSTIMESTAMP" FROMINSTANCE="EXP_PARAMS" FROMINSTANCETYPE="Expression" TOFIELD="DWSTIMESTAMP" TOINSTANCE="NA2PFRATE002_BRIDGE_DSRC" TOINSTANCETYPE="Target Definition"></CONNECTOR>
        <CONNECTOR FROMFIELD="DEL_FLAG" FROMINSTANCE="SQ_NA2PF002_DELTA" FROMINSTANCETYPE="Source Qualifier" TOFIELD="DEL_FLAG" TOINSTANCE="NA2PFRATE002_BRIDGE_DSRC" TOINSTANCETYPE="Target Definition"></CONNECTOR>
        <CONNECTOR FROMFIELD="YAROED" FROMINSTANCE="YARPFSAVINGS002_BRIDGE_MIRROR" FROMINSTANCETYPE="Source Definition" TOFIELD="YAROED" TOINSTANCE="SQ_NA2PF002_DELTA" TOINSTANCETYPE="Source Qualifier"></CONNECTOR>
        <CONNECTOR FROMFIELD="YARCED" FROMINSTANCE="YARPFSAVINGS002_BRIDGE_MIRROR" FROMINSTANCETYPE="Source Definition" TOFIELD="YARCED" TOINSTANCE="SQ_NA2PF002_DELTA" TOINSTANCETYPE="Source Qualifier"></CONNECTOR>
        <CONNECTOR FROMFIELD="NA2EAN" FROMINSTANCE="NA2PF002_DELTA" FROMINSTANCETYPE="Source Definition" TOFIELD="NA2EAN" TOINSTANCE="SQ_NA2PF002_DELTA" TOINSTANCETYPE="Source Qualifier"></CONNECTOR>
        <CONNECTOR FROMFIELD="NA2RAT" FROMINSTANCE="NA2PF002_DELTA" FROMINSTANCETYPE="Source Definition" TOFIELD="NA2RAT" TOINSTANCE="SQ_NA2PF002_DELTA" TOINSTANCETYPE="Source Qualifier"></CONNECTOR>
        <CONNECTOR FROMFIELD="NA2DB" FROMINSTANCE="NA2PF002_DELTA" FROMINSTANCETYPE="Source Definition" TOFIELD="NA2DB" TOINSTANCE="SQ_NA2PF002_DELTA" TOINSTANCETYPE="Source Qualifier"></CONNECTOR>
        <CONNECTOR FROMFIELD="NA2DE" FROMINSTANCE="NA2PF002_DELTA" FROMINSTANCETYPE="Source Definition" TOFIELD="NA2DE" TOINSTANCE="SQ_NA2PF002_DELTA" TOINSTANCETYPE="Source Qualifier"></CONNECTOR>
        <CONNECTOR FROMFIELD="NA2EAN" FROMINSTANCE="NA2PF002_DELTA" FROMINSTANCETYPE="Source Definition" TOFIELD="DEL_FLAG" TOINSTANCE="SQ_NA2PF002_DELTA" TOINSTANCETYPE="Source Qualifier"></CONNECTOR>
        <CONNECTOR FROMFIELD="NA2EAN" FROMINSTANCE="SQ_NA2PF002_DELTA" FROMINSTANCETYPE="Source Qualifier" TOFIELD="NA2EAN" TOINSTANCE="EXP_PARAMS" TOINSTANCETYPE="Expression"></CONNECTOR>
        <TARGETLOADORDER ORDER="1" TARGETINSTANCE="NA2PFRATE002_BRIDGE_DSRC"></TARGETLOADORDER>
        <MAPPINGVARIABLE DATATYPE="decimal" DEFAULTVALUE="" DESCRIPTION="" ISEXPRESSIONVARIABLE="NO" ISPARAM="YES" NAME="$$P_DWSJOB" PRECISION="28" SCALE="0" USERDEFINED="YES"></MAPPINGVARIABLE>
        <MAPPINGVARIABLE DATATYPE="integer" DEFAULTVALUE="" DESCRIPTION="" ISEXPRESSIONVARIABLE="NO" ISPARAM="YES" NAME="$$P_INITIAL_LOADING" PRECISION="10" SCALE="0" USERDEFINED="YES"></MAPPINGVARIABLE>
        <ERPINFO></ERPINFO>
        <METADATAEXTENSION DATATYPE="STRING" DESCRIPTION="" DOMAINNAME="User Defined Metadata Domain" ISCLIENTEDITABLE="YES" ISCLIENTVISIBLE="YES" ISREUSABLE="YES" ISSHAREREAD="NO" ISSHAREWRITE="NO" MAXLENGTH="256" NAME="CREATOR" VALUE="XXX" VENDORNAME="INFORMATICA"></METADATAEXTENSION>
    </MAPPING>
</FOLDER>
</REPOSITORY>
</POWERMART>
